<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />

    {% include _head/keywords.liquid %}
    {% include _head/page_title.liquid %}
    {% include _head/page_description.liquid %}
    {% include _head/page_image.liquid %}
    {% include _head/seo.liquid %}
    {% include _head/seo_facebook.liquid %}
    {% include _head/seo_twitter.liquid %}
    {% include _head/seo_google.liquid %}
    {% include _head/seo_canonical.liquid %}

    <link href="/SpoqaHanSans-kr.css" rel="stylesheet" type="text/css" />
    <link href="/JetBrainsMono.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body>
    <header >
      <div class="w">
      {%- assign footer_chars = site.title | split: ""-%}
        {% for footer_char in footer_chars %}
        <span>{{- footer_char -}}</span>
        {% endfor %}
      </div>
      {% if site.theme_config.show_description == true %}
        <p>{{ site.description }}</p>
      {% endif %}
    </header>

    <main class="page-content" aria-label="Content">
      <div class="w">
        {{ content }}
      </div>
    </main>

    {% if site.goat_counter and jekyll.environment == "production" %}
      {% include goat_counter.liquid %}
    {% endif %}

    <footer>
      {%- assign footer_words = site.description | split: ""-%}
      <div class="w">
        {% for footer_word in footer_words %}
        <span>{{- footer_word -}}</span>
        {% endfor %}
        <a href="https://github.com/Rockheung/rockheung.github.io/pulls"
          >Coded by Rockheung in Korea, Compiled in... Merge?</a
        >
      </div>
    </footer>
    <script>
      var RANDOM_INTENSITY = 24;
      var DURATION = 41.667;
      function footer_rainbow() {
        var footer_spans = document.querySelectorAll("header span");
        var seed_color = {
          r: Math.floor(Math.random() * 256),
          g: Math.floor(Math.random() * 256),
          b: Math.floor(Math.random() * 256)
        };
        var footer_spans_color = Array.from(
          new Array(footer_spans.length),
          function() {
            return seed_color;
          }
        );
        var lastTimestamp = null; 
        function rainbow_step(timestamp) {
          if (!lastTimestamp) lastTimestamp = timestamp;

          if (timestamp - lastTimestamp < DURATION ) {
            return window.requestAnimationFrame(rainbow_step);
          }

          var d_color = {
            r: Math.floor((Math.random() - 0.7) * RANDOM_INTENSITY),
            g: Math.floor((Math.random() - 0.7) * RANDOM_INTENSITY),
            b: Math.floor((Math.random() - 0.7) * RANDOM_INTENSITY),
          };

          var offset_color = {
            r:
              (footer_spans_color[footer_spans_color.length - 1].r +
                d_color.r) %
              256,
            g:
              (footer_spans_color[footer_spans_color.length - 1].g +
                d_color.g) %
              256,
            b:
              (footer_spans_color[footer_spans_color.length - 1].b +
                d_color.b) %
              256,
          };

          if (offset_color.r < 0) offset_color.r = offset_color.r + 256
          if (offset_color.g < 0) offset_color.g = offset_color.g + 256
          if (offset_color.b < 0) offset_color.b = offset_color.b + 256

          footer_spans_color.unshift(offset_color);
          footer_spans_color = footer_spans_color.slice(0,footer_spans.length);
          footer_spans.forEach(function(spanEle, idx) {
            spanEle.setAttribute(
              "style",
              "color: rgba(" +
                footer_spans_color[idx].r +
                "," +
                footer_spans_color[idx].g +
                "," +
                footer_spans_color[idx].b +
                ",0.8)"
            );
          });
          window.requestAnimationFrame(rainbow_step);
          lastTimestamp = timestamp;
        }
        window.requestAnimationFrame(rainbow_step);
      }
      footer_rainbow();
    </script>
  </body>
</html>
