---
layout: post
title: '남이 만든 리액트 사이트 업데이트하기'
date:   2019-05-24 00:00:00.123 +0900
author: Rockheung
tags: react javascript web legacy
categories: Study

---
리액트 15.6으로 작성된 페이지를 업데이트할 일이 생겼다.

mongodb + express + react 조합의 사이트여서 db를 제외하면 내게는 익숙했다. 조합만 그랬다.

git clone을 받았더니 `node_modules`가 딸려 왔다. `.gitignore`에는 이해할 수 없게도 `node_modules`가 목록에 없었다. `README.md`와 `README.MD`가 2개 있었는데, 하나는 firebase에서 자동으로 만들어준 듯했다. 왜 지우지 않은 걸까. 직접 작성한 듯한 `README.MD`의 내용은 확장자를 무색케 하는 그냥 줄글로 되어 있었다. 그냥 강조하고 싶은 멘트만 `#`을 붙여 놓았다. 그런건 볼드체나 이텔릭체를 써야하지 않나...? 무튼 영양가가 없었다. 아무래도 서버로직은 직접 코드를 까봐야 할 듯 싶었다.

무엇을 먼저 봐야 하나 고민하다가, `package.json`을 열어봤다. 오만 가지 패키지가 덕지덕지 깔려 있었다. 일단 지우지는 않았다. 문제가 생길지도 모르니까 말이다. 당시에는 `create-react-app`같은게 없었던 걸까? 겨우 1년 전인데. 정말 궁금해져서 [Github/facebook/create-react-app](https://github.com/facebook/create-react-app)에 가봤다. v1은 분명 2년 전에도 있었다. 아마도 `eject`를 한게 아닐까 싶었다. 웹팩 설정 파일이 밖에서 나뒹굴고 있었으니까. 

개발과 베포를 동시에 한 걸까, 하는 의문이 들었다. 개발 과정조차 스파게티인데, 코드를 열어보기가 갑자기 겁이 났다. 

일단 나의 계획은 이렇다. 현재 서버는 Linode의 싱글코어 인스턴스를 쓰고 있는데, 일본 도쿄에 있다. 근데 `bundle.js`를 받아오는 데에 시간이 너무 오래 걸린다. 최근에 Linode가 너무 느려졌다. 서버를 바꾸느냐, 페이지를 가볍게 하느냐를 선택해야 하는데, Next.js를 한번 써볼까 싶다. 덤으로 typescipt를 쓰고, db를 aws의 dynamoDB로 마이그레이션할 계획도 가지고 있다. 25기가까지 평생 공짜이니, 별 무리가 없지 싶다. 

-----------------------------

전반적인 개선 방향은 아래와 같이 잡았다:

1. API flow 파악: 어떤 api에 요청을 해서 무엇을 db에서 가져오는지 백로직 파악
2. jQuery 걷어내기: 전반적으로 전체 앱에 마치 X처럼 발라져 있다. 그간 보였던 이상한 현상(특정 돔이 보였다가 안보였다가 하는 일관적이지 않은 동작 등)의 원인인 듯 싶다.
3. 이후 중단된 패키지 업그레이드, 필요없는 패키지 의존성 최소화


> Written with [StackEdit](https://stackedit.io/).



